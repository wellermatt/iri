<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title></title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>




</head>

<body>
<pre><code class="r">### ROLLING REGRESSION FUNCTIONALITY TESTING &amp; LOOPING ####
setwd(&quot;C:/Users/matt/Dropbox/HEC/Code/iri&quot;)
# setwd(pth.dropbox.code) rm(list=ls())
source(&quot;./.Rprofile&quot;)

require(&quot;forecast&quot;)
</code></pre>

<pre><code>## Loading required package: forecast
</code></pre>

<pre><code>## This is forecast 4.06
</code></pre>

<pre><code class="r">require(&quot;data.table&quot;)
</code></pre>

<pre><code>## Loading required package: data.table
</code></pre>

<pre><code class="r">require(&quot;reshape2&quot;)
</code></pre>

<pre><code>## Loading required package: reshape2
</code></pre>

<pre><code class="r">require(&quot;ggplot2&quot;)
</code></pre>

<pre><code>## Loading required package: ggplot2
</code></pre>

<pre><code class="r">require(&quot;foreach&quot;)
</code></pre>

<pre><code>## Loading required package: foreach
</code></pre>

<pre><code class="r">
setwd(pth.dropbox.code)
source(&quot;./data/DataAdaptor/00_data_adaptor_test.R&quot;)
</code></pre>

<pre><code>## Warning: Adding new column &#39;hol_Easter_LEAD1&#39; then assigning NULL (deleting it).
</code></pre>

<pre><code>## Warning: Adding new column &#39;hol_Halloween_LEAD1&#39; then assigning NULL (deleting it).
</code></pre>

<pre><code>## Warning: Adding new column &#39;hol_Independence_LEAD1&#39; then assigning NULL (deleting it).
</code></pre>

<pre><code>## Warning: Adding new column &#39;hol_Labor_LEAD1&#39; then assigning NULL (deleting it).
</code></pre>

<pre><code>## Warning: Adding new column &#39;hol_Memorial_LEAD1&#39; then assigning NULL (deleting it).
</code></pre>

<pre><code>## Warning: Adding new column &#39;hol_NYE_LEAD1&#39; then assigning NULL (deleting it).
</code></pre>

<pre><code>## Warning: Adding new column &#39;hol_Presidents_LEAD1&#39; then assigning NULL (deleting it).
</code></pre>

<pre><code>## Warning: Adding new column &#39;hol_Superbowl_LEAD1&#39; then assigning NULL (deleting it).
</code></pre>

<pre><code>## Warning: Adding new column &#39;hol_Thanksgiving_LEAD1&#39; then assigning NULL (deleting it).
</code></pre>

<pre><code>## Warning: Adding new column &#39;hol_Xmas_LEAD1&#39; then assigning NULL (deleting it).
</code></pre>

<pre><code>## Warning: Adding new column &#39;hol_Easter_LAG1&#39; then assigning NULL (deleting it).
</code></pre>

<pre><code>## Warning: Adding new column &#39;hol_Halloween_LAG1&#39; then assigning NULL (deleting it).
</code></pre>

<pre><code>## Warning: Adding new column &#39;hol_Independence_LAG1&#39; then assigning NULL (deleting it).
</code></pre>

<pre><code>## Warning: Adding new column &#39;hol_Labor_LAG1&#39; then assigning NULL (deleting it).
</code></pre>

<pre><code>## Warning: Adding new column &#39;hol_Memorial_LAG1&#39; then assigning NULL (deleting it).
</code></pre>

<pre><code>## Warning: Adding new column &#39;hol_NYE_LAG1&#39; then assigning NULL (deleting it).
</code></pre>

<pre><code>## Warning: Adding new column &#39;hol_Presidents_LAG1&#39; then assigning NULL (deleting it).
</code></pre>

<pre><code>## Warning: Adding new column &#39;hol_Superbowl_LAG1&#39; then assigning NULL (deleting it).
</code></pre>

<pre><code>## Warning: Adding new column &#39;hol_Thanksgiving_LAG1&#39; then assigning NULL (deleting it).
</code></pre>

<pre><code>## Warning: Adding new column &#39;hol_Xmas_LAG1&#39; then assigning NULL (deleting it).
</code></pre>

<pre><code class="r"># setwd(pth.dropbox.code) ;
# source(&#39;./model/ModelFitting/ets/ets_functions.R&#39;)
setwd(pth.dropbox.code)
source(&quot;./model/ModelFitting/RegressionModelling/02_regression_functions_modelling.R&quot;)
setwd(pth.dropbox.code)
source(&quot;./model/ModelFitting/RegressionModelling/10_regression_roll_functions.R&quot;)
source(&quot;./model/ModelFitting/RegressionModelling/03_regression_functions_diagnostics.R&quot;)
</code></pre>

<pre><code>## Attaching package: &#39;plyr&#39;
</code></pre>

<pre><code>## The following object is masked _by_ &#39;.GlobalEnv&#39;:
## 
## unrowname
</code></pre>

<pre><code class="r">source(&quot;./other/GenericRoutines/useful_functions.R&quot;)


# ============== DATA LOADING ===================== get the necessary data
# for a specific item: weekly or monthly data loaded
spw = f_da.reg.cat.test(par.category = &quot;beer&quot;, par.periodicity = &quot;weekly&quot;)  # spw is the regression dataset, all nodes
spm = f_da.reg.cat.test(par.category = &quot;beer&quot;, par.periodicity = &quot;445&quot;)  # spm is 445 version of above


# items = spw[!is.na(IRI_KEY),as.character(unique(fc.item))]
items = spm[, as.character(unique(fc.item))]

print.options = list(opt.print.summary = TRUE, opt.print.aov = TRUE, opt.print.diag = TRUE, 
    opt.print.stats = TRUE, opt.print.coef = TRUE)
expt.design.master = data.table(id = 1:3, include.AR.terms = FALSE, log.model = FALSE, 
    price.terms = c(&quot;PRICE_DIFF&quot;, &quot;PRICE&quot;, &quot;PRICE_LAG&quot;), time.period = &quot;WEEK&quot;)
expt.design = as.list(expt.design.master[2])
for (x in names(expt.design)) assign(x, expt.design[[x]])

## main functions: take a model (), get the xreg : the x values for future
## periods



# major decisions here about the paramters in terms of variable selection:
# price: diff/lag/log promo: lag/split/combination (FEAT/DISP)

# hols:

# model.config
log.model = FALSE
include.AR.terms = FALSE
price.terms = &quot;PRICE_DIFF&quot;

periodicity = &quot;weekly&quot;




## SET UP MULTICORE determine which OS (Windows/Linux)


# for each fc.item (at each level) the list of items will be used

rr = f_reg.roll.multi()
</code></pre>

<pre><code>## [1] &quot;00-01-18200-53030&quot;
## Price Vars  PRICE_DIFF 
##  Price Vars  PRICE_DIFF_LAG1 
##  Price Vars  PRICE_DIFF_LAG2 
## Explanatory Vars  FEAT_A 
##  Explanatory Vars  FEAT_A_PLUS 
##  Explanatory Vars  FEAT_B 
##  Explanatory Vars  FEAT_C 
##  Explanatory Vars  DISP_MINOR 
##  Explanatory Vars  DISP_MAJOR 
##  Explanatory Vars  FEAT_ANY_LAG1 
##  Explanatory Vars  FEAT_ANY_LAG2 
##  Explanatory Vars  FEAT_ANY_LAG3 
## [1] &quot;00-01-18200-53030/104&quot;
## Price Vars  PRICE_DIFF 
##  Price Vars  PRICE_DIFF_LAG1 
##  Price Vars  PRICE_DIFF_LAG2 
## Explanatory Vars  FEAT_A 
##  Explanatory Vars  FEAT_A_PLUS 
##  Explanatory Vars  FEAT_B 
##  Explanatory Vars  FEAT_C 
##  Explanatory Vars  DISP_MINOR 
##  Explanatory Vars  DISP_MAJOR 
##  Explanatory Vars  FEAT_ANY_LAG1 
##  Explanatory Vars  FEAT_ANY_LAG2 
##  Explanatory Vars  FEAT_ANY_LAG3 
## [1] &quot;00-01-18200-53030/104/228694&quot;
## Price Vars  PRICE_DIFF 
##  Price Vars  PRICE_DIFF_LAG1 
##  Price Vars  PRICE_DIFF_LAG2 
## Explanatory Vars  FEAT_A 
##  Explanatory Vars  FEAT_A_PLUS 
##  Explanatory Vars  FEAT_B 
##  Explanatory Vars  FEAT_C 
##  Explanatory Vars  DISP_MINOR 
##  Explanatory Vars  DISP_MAJOR 
##  Explanatory Vars  FEAT_ANY_LAG1 
##  Explanatory Vars  FEAT_ANY_LAG2 
##  Explanatory Vars  FEAT_ANY_LAG3
</code></pre>

<pre><code class="r">
saveResults = FALSE
if (saveResults == TRUE) {

    setwd(pth.dropbox.data)
    saveRDS(results.all, &quot;./output/errors/errors_reg1.rds&quot;)
    setwd(pth.dropbox.code)

}

library(stringr)
rr[, `:=`(lvl, str_count(fc.item, &quot;/&quot;) + 1)]
</code></pre>

<pre><code>##                            fc.item periodicity   t k      fc  act        e      ae        re      rae lvl
##    1:            00-01-18200-53030      weekly 207 1 3730.66 3553  177.660 177.660  0.050003 0.050003   1
##    2:            00-01-18200-53030      weekly 207 2 3411.37 3419   -7.635   7.635 -0.002233 0.002233   1
##    3:            00-01-18200-53030      weekly 207 3 1825.45 1417  408.448 408.448  0.288248 0.288248   1
##    4:            00-01-18200-53030      weekly 207 4 1264.84 1419 -154.158 154.158 -0.108638 0.108638   1
##    5:            00-01-18200-53030      weekly 207 5 2144.07 1878  266.067 266.067  0.141676 0.141676   1
##   ---                                                                                                    
## 3896: 00-01-18200-53030/104/228694      weekly 310 2   28.06   38   -9.945   9.945 -0.261702 0.261702   3
## 3897: 00-01-18200-53030/104/228694      weekly 310 3   19.25   39  -19.747  19.747 -0.506335 0.506335   3
## 3898: 00-01-18200-53030/104/228694      weekly 311 1   28.16   38   -9.837   9.837 -0.258862 0.258862   3
## 3899: 00-01-18200-53030/104/228694      weekly 311 2   19.60   39  -19.399  19.399 -0.497418 0.497418   3
## 3900: 00-01-18200-53030/104/228694      weekly 312 1   19.71   39  -19.292  19.292 -0.494658 0.494658   3
</code></pre>

<pre><code class="r">rr[, list(mape = mean(abs(re), na.rm = TRUE)), by = list(lvl, k)]
</code></pre>

<pre><code>##     lvl  k   mape
##  1:   1  1 0.1223
##  2:   1  2 0.1233
##  3:   1  3 0.1251
##  4:   1  4 0.1236
##  5:   1  5 0.1241
##  6:   1  6 0.1242
##  7:   1  7 0.1259
##  8:   1  8 0.1264
##  9:   1  9 0.1271
## 10:   1 10 0.1280
## 11:   1 11 0.1294
## 12:   1 12 0.1295
## 13:   1 13 0.1298
## 14:   2  1 0.2717
## 15:   2  2 0.2736
## 16:   2  3 0.2759
## 17:   2  4 0.2763
## 18:   2  5 0.2794
## 19:   2  6 0.2817
## 20:   2  7 0.2833
## 21:   2  8 0.2867
## 22:   2  9 0.2891
## 23:   2 10 0.2906
## 24:   2 11 0.2939
## 25:   2 12 0.2945
## 26:   2 13 0.2955
## 27:   3  1 0.4932
## 28:   3  2 0.4955
## 29:   3  3 0.4986
## 30:   3  4 0.5013
## 31:   3  5 0.5026
## 32:   3  6 0.5077
## 33:   3  7 0.4984
## 34:   3  8 0.4988
## 35:   3  9 0.5048
## 36:   3 10 0.5072
## 37:   3 11 0.5076
## 38:   3 12 0.5137
## 39:   3 13 0.5106
##     lvl  k   mape
</code></pre>

<pre><code class="r">
dcast(data = rr, k ~ lvl, fun.aggregate = mean, na.rm = TRUE, value.var = &quot;rae&quot;)
</code></pre>

<pre><code>##     k      1      2      3
## 1   1 0.1223 0.2717 0.4932
## 2   2 0.1233 0.2736 0.4955
## 3   3 0.1251 0.2759 0.4986
## 4   4 0.1236 0.2763 0.5013
## 5   5 0.1241 0.2794 0.5026
## 6   6 0.1242 0.2817 0.5077
## 7   7 0.1259 0.2833 0.4984
## 8   8 0.1264 0.2867 0.4988
## 9   9 0.1271 0.2891 0.5048
## 10 10 0.1280 0.2906 0.5072
## 11 11 0.1294 0.2939 0.5076
## 12 12 0.1295 0.2945 0.5137
## 13 13 0.1298 0.2955 0.5106
</code></pre>

<pre><code class="r">dcast(data = results.all[lvl == 2], fc.item ~ k, fun.aggregate = mean, na.rm = TRUE, 
    value.var = &quot;rae&quot;)
</code></pre>

<pre><code>## Error: object &#39;results.all&#39; not found
</code></pre>

<pre><code class="r">
# results[,list(mape = mean(abs(re))),by=k]

qplot(data = rr, x = re) + facet_wrap(facets = ~lvl, ncol = 1, scales = &quot;free&quot;)
</code></pre>

<pre><code>## stat_bin: binwidth defaulted to range/30. Use &#39;binwidth = x&#39; to adjust this.
</code></pre>

<pre><code>## stat_bin: binwidth defaulted to range/30. Use &#39;binwidth = x&#39; to adjust this.
</code></pre>

<pre><code>## stat_bin: binwidth defaulted to range/30. Use &#39;binwidth = x&#39; to adjust this.
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">ggplot(data = rr, aes(x = re, colour = factor(k))) + geom_density() + facet_wrap(facets = ~lvl, 
    scales = &quot;free&quot;)
</code></pre>

<pre><code>## Warning: Removed 8 rows containing non-finite values (stat_density).
</code></pre>

<pre><code>## Warning: Removed 7 rows containing non-finite values (stat_density).
</code></pre>

<pre><code>## Warning: Removed 6 rows containing non-finite values (stat_density).
</code></pre>

<pre><code>## Warning: Removed 6 rows containing non-finite values (stat_density).
</code></pre>

<pre><code>## Warning: Removed 6 rows containing non-finite values (stat_density).
</code></pre>

<pre><code>## Warning: Removed 6 rows containing non-finite values (stat_density).
</code></pre>

<pre><code>## Warning: Removed 6 rows containing non-finite values (stat_density).
</code></pre>

<pre><code>## Warning: Removed 6 rows containing non-finite values (stat_density).
</code></pre>

<pre><code>## Warning: Removed 6 rows containing non-finite values (stat_density).
</code></pre>

<pre><code>## Warning: Removed 6 rows containing non-finite values (stat_density).
</code></pre>

<pre><code>## Warning: Removed 6 rows containing non-finite values (stat_density).
</code></pre>

<pre><code>## Warning: Removed 6 rows containing non-finite values (stat_density).
</code></pre>

<pre><code>## Warning: Removed 6 rows containing non-finite values (stat_density).
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAABNVBMVEUAAAAAADoAAFIAAGYALnMAOjoAOpAAUpEAZrYArPwAu9oAvnAAwasktwAuc686AAA6ADo6AGY6OgA6OmY6OpA6ZrY6kNtSAFJSkcxmAABmADpmAGZmOgBmOjpmOpBmZmZmtv9zLgBzLlJzc5F/f39/f5V/f6t/lcF/q9aLk/+MqwCQOgCQOjqQOmaQZpCQkLaQ27aQ2/+RUgCRzMyVf3+VlcGVweurf5Wrf6urlZWrlcGrq6ur1v+vcy6vzMy2ZgC2Zjq2tma2/7a2//++nADBlX/BlZXBlavBwdbB6//MkVLMzJHMzK/MzMzVdf7Wq3/W///bkDrbtmbb/7bb///higDl5eXrwZXr1qvr///y8vL4dm35Yt3/Zaz/tmb/1qv/25D/68H//7b//9b//9v//+v///9BH9a5AAAACXBIWXMAAAsSAAALEgHS3X78AAAgAElEQVR4nO3dib/cNn4Y8Oeqdc0rzrapUnnbxknfekW6aaJtqm68apVEdHad7s6zWpOqhuR7ig7+/39CAZ64ByBxcEj8PrYeh+CBwXdAghd40/o4ZNy4zoAPN+HhDxoe/qDh4Q8aHv6g4eEPGh7+oOHhDxoe/qDh4Q8aHv6g4eEPGh7+oCEH/we74fMhm5Hl4eGvIB8e/qD58PAHzYeHP2g+rg3+f//pf9P8PRct7fd/fnPzL/+X+3z84Vc3N/9+2ZzKrJfDIPw/3fyLTcD/078GZb6oxLXnY2lVUGa9HObgf/+ff/8Xm4CH8T83AP+H5dtAZdbLYXJTvx14WOk3kI9f3fzRshmVWS/HIeB/tczdxJZnmbwy6+U4APzv/3xhk0r3Pv6PPPzS77loaaAxfbNsG6u5PEBGdG96loc/jr+CfHj4g+bDHXwJ4lzO0c6DnNHrxovywZgeX5IoSS1NlA98VmLeS8mqqcqsl8PDC9JE+fDwnBx7eEGyh+eMF+WDWVgeXjU8vCBNlA8Pz8mxhxcke3jOeFE+mIXl4VXDwwvSunV++PWP8M+n729vf/l2zoeH5+R4L/APt9908A9P2/buxZwPD8/J8U7gP/3u029/HFf/BsLfglhb6hsIDy9I69Y5w8NKP+XD13hOjvcHf/cUzYeH5+R4b/Cfvn+B5cPDc3K8K/gP3729g/v253M+PDwnx7uB5+TDw3Ny7OEFyR6eM16UD2ZheXjV8PCCNFE+PDwnxx5ekOzhOeNF+WAWlodXDUPwcWwdvoq5SaLZRGmifAjsGnHyglRl1sthBj4urcNXcRxzkohSlE8T5cPDs0Y7gS89vEIYg4/ZkxuEjzy8QpiCL23Dx1Hh4RXCCHxcWocHFb4Yq7xj+AbKe3jymxiCB9W9KD28fOwHPkkKDy8fZuCjyAF8mXh4+TBU46PyHDMnNwifeXiFMAEfR2EYWYaPoyxLhtadh5cIQ/BlaBe+iKMyG6u8h5cII/BhmFiHT8rQwyuEGfjEAXwIfm7bgK+PC1+VUWgZvgS7Fw8vH6bgEw/PX/RO4aMwKSvr8GFZ5mFc0UkenhkG4KGBE/gyBG17KsnDM8MUPNjyxqzJDcHnPXy/rXcNfzoufBYEaOvOODw4jA9TD68SRuCBexDYhU/SNC2z0MPLhn74CsKDOm8XPkyDFLbu6HL08MzQDx/BLb0T+LT08NJhAj4rgtw+fFlC+IoqR/vwBz1lG8EtfZ6dA6vwaeDhlcIQfNNkNuHzCT6iytE+fHhM+K5t19SNZXjwbxp4eOnQDg8a9XnQNGkThMxvYgQ+6+DLtD+e8/ASoR++r/BpUzuAzzcBHxwSvt/F16dTYxM+TOu6LofjOQ8vEYbgUwA/7+RNwxdZGtRlPTbrPbxEcOHvbm/n/r3I3F2EPxWZTfgYwpc1bN15eLngwT88HXvvHb6oCjzY0pd5U9uEL8HOZSvw134c38PfKvbdGsFGfX1qIfzazFHBKSwAXzdNDx+5hm/qK4e/m7rzU6nxVRTCtl1pu8Z38PB4zsPLhahx92aSJ3MngI9H+KyxCd+ADSyo8puAj+vmeuEfni+E79t2HXzImNwYfNnBlx5eMkSteqy3ZgV42LYDh1j24PMJvmvdeXiJ0H0cHyHwKeubmIGH9zfC84UeXjbMwJcdfM36Jibgs3RT8OUx4fu2XXm2Cg/dLcKfz2f4PzOa+lw3/OQuVFOVWS+HOfjcADynpAB8V+Rds75SKOQLaaLyENT45IA1vj+MP5WG4DnTjzV+OJ5zvKk/efiYntwEfDHA99v6qPLwEmEAvmvUA/j5DM7R4IMDwodx36i3Ch9vCz46JPzQtrMLXyPwsYeXCc3w0QyPnMExDt/0KaB1twH44LDwp268I3h4PCcoRg8/hFH4mp7cNDzY1juHL48NX9qHH1t3gmK0Ah8fEn7gtgife3j10AtfofC5LXhwGL8p+MzDM77J/uHjQ8KPR3OO4OHxnHv46HjwU9sOwkcN45uYhi9Bs15QjB5+CO3w6QyfuIAH2/pCUIw24PODwo/j88wWfHMaUxg7eQ/PDL3wc9sOjJ9P3RmHLzcFX3h4K/CFh18QZuFP9DcxAJ9g8GXgGD4qjwifzvDVdOrOMDxSzn2zPuEXoxX47HjwU6MejrcFH3t49dAKX0VTo94VfEnt5D08M3YGP+zk0Srv4ZmhG346TXsu53O2Hn7v8KEL+Dwl4UMPfzE0w6cY/Hiy3jp8gcg7gM+PBl+EU6PeInyGwYPWXYxt6z08M7TDI+NtwYOtDAZ/BvCzvHX47IDwAQ6fWII/kfBh5eEvhFb4CIcvkuFkvWl4dElgJ3+OA7fw5dHhx5P1duFPcCdfTvIenhl64edGvTv4rnUXevgLYRJ+ukpjG76MA4fw+eHgq2g+mnMJj2/rPTwzdMNj413Bn+IgcAdfeHg78Aneg2hTn08wHME39QHhQxfwBQkPO65Pg2zc6ViHrw4HX5DwuRX4iIaH8s7gy+PBz9fmbMLHDPg4TTPGDX8efgqt8Okm4OFKYyDv4UWhGR4fP16lsQpfNmcon7uErxuT8O+f3DxGP//dM+TDy8fv/hh+fv2FmHQH8CkPnj5taAMertUsfC87xf1nyMf3Xz3rk9/97JWQVCd85AYe1jECvgbb+iDdKfzHb28+++snNzef/9S+vrn5An589hIMtPc3N4/+/tErAA9+C++ffO0OvrABn8Oixsqqb97tFn6o8QC394UDj169f/L4/ubr9vXnP73747/+6hn4eTxmZt0OfNKfwjUK3z2aScKDKh/tGh5U8c+eAeX+FwAHXn4Bt/kvIfy/+QzCi3fyZuEzJ/BnKF/FjuAD8E9kGh749jUeVOy5xgPvrsbDZIs1vtoOfBfBjuHB7vxfffk13McD6C/HfTyAv+/28UDd4j6+iuZrc/34yhE8/Kduhp38Svi721/8AP9++v52fh8bNSsCD/txNQsvCtCq7wcstuqxo7kRvia/iS14IK8D/uGXb8F/YODNU/AjeDHnY6Pw4Di+/2vxOJ6GL68f/s3z4Y2b8F1sd7DKX3jzZgPfrwngtx77hS/0wL9oP/0WwsNN/W+ez/kQ1vjMaI2vqPDwSFJR0w2MFTW+bZE3MFKz2oUn3p5jEF7qJT5F/0ogNPKmFr3zhzueF6zC4sFXsQ74aR8PX6/9P36QgI9Ky/DVeXs1PndY40st8H2r/sN3b+GrN18g+RDC5xbhwadjwic8+FwLPC8fW4GHHzw8lnQI+G7YMXyCnr8Z4PurNEbhIx58UVMrtwVf2oLvBx3D42ctrMF3GxUmfL+T3zP8MATh3/9cfKaODLPwhYdnLVoX/DgA4O9vHm0Mnix7/fCU7pBU7R1+/gG0H//q41+6gq9SBnxiAT4ky8otfNb9awEe2eKDke7gCwb8cHnOJHxBt+DGpHzX8GgTr/XwaJIb+Lz71zg8dkzXeng0yQ1895oE4/D4SZx2g/Bkm9sifLFfeOKsrRQiHmbhS7fwNXVuZyfw5GUaKUQ8NMI39dbgQxfwXQfKhq/Hn7cFz4DMjcNnx4MvqJBCxGO78OP9D+PdjmM+iOkF8P2BvG34/l+j8ESFdwyf6YV/uP2mg5/uhPDwHPji7BY+0Qr/6Xf9rW7TvU+3nJscM/59jRB+QZHIlcdm4MGnPcG37Qg/3u045oOYXlDjGY/V7a/Gww9u4SMmPHW1XBkevduRMf3B4btht/ApC75YDb9iH38A+H5wf/D9TY5LW/X7hx+GCvjM/E336Kx9+EI3PC8fxPRC+LrZNfw4ULT3X7TtS/FTkkQYhu+v0riCL4J9w08/gG70aw8/DnSn7vYLX2Dw9xeekiRCHzz6gpDSHjx9A/dR4Ausxr9Uc9cJH28PnuwJbU/waNseNO6UtvOtcfjSPDz91MQh4LGDedglzg3e+d2l0AjPhMzIzshswncn693Ah5xk1nqXwONn76QQ8dAGn7Phc+PwAVVWB4AnTtdLIeKhDT5zA1/0RcyBz3cKT16fk0LE4/rh6bKaF2UfPrUBT12Ql0LEw8ML0kT54NgN/XUbhc+pkELEQxt84uFhWIEnKvwm4akuhq3Cw3O2buBP7GTmelfC52en8GTn4SNMxB5PfcOF8Nnh4cEnD08uygH8Cf3DWbROePjBJTz1uoBtwId7h++GncJz9uUVp7VPfUMPL0jF154T7hD+5c2N2tl6ffDsc/JVRjSs7cLH1uHj7k/dsJOZ610OPwzl8JqsYl8o+uDDDcJX+4YfB7pNvYffAnxpA37+AbRwW690cU4jfMyGPBp8NPxlJzPXuxAe2eJ3o187uSyb826qJE+eaYZnvNIQhY/2C4828dr7x67gqR5lNwEPtzc7hceO6bpWvZt77gTwrHvx6G+4FJ7x4hlkUfle4fGTOFKIeHh4QZooH27hibO2Uoh4XD18SpeVefgzt6/9Jhr+spOH4HXUz0vF156fycs0Uoh4GIdn33ZNl/tS+IAWRBZVBI3lGp8Pf9nJzPUq13jquqwUIh664KnOw23Bh3RZOYUvhr/sZOZ6VeEzKqQQ8dAFn7qCj+my2j08UeGPCc8oq4PBZ2eX8NyeLwpmhwn0N1wGX1yCD23DV8NfdjJzvevgwSeH8AUXnjx55uH5M3NT8bVnhLtbeLLz8Ame2RsW/Q3NwFfW4Ym/zEVrhO+Gtwp/cggf7xu+H+zg1U7VXzt8dmz4YQjC32u6LAtfpTr1OXQZPufCkyfPPDx/Zm4qvvaMcIfw7/7k/+iBf0Dfmi0DH5cevrQLP/8A4O039/o29W8gPK9HSSIv/P4lc43dS1KFdQmeepP7juCRLX77Wufz8bDSIwUurPF0TzTbqPE7hkebeHCsthp/N7tfMTz5XufdwGPHdHCsJvhP379APpG5U4FnvsCA/obL4IcbcPjwOXGH+17g8ZM48t5T8ODv4K79OVrg1wlf7BOeOGurRN6HpuN4Z/AnRllh8MQd7vuAJy/TSCHioQk+2Sx8sEN46rqsFCIe1w6fMspq7/AJFVKIeGiCp7sZnCavGC8bZnxDDy9IxdeeEBX+kPAho6wOBp+c3cEXIvjMKXy4d3jwySU81dvcDJ+bhI8ZZYUuqto7PPywTXjiHIqH58/MTcXXnhDuDuFzZ/CsssLgY0fwITOZud4V8P2gh6cXtW/4YSjpHpr87JmU5RAeXpAmyscW4MeBpP34X5TUW13wWb+vZUMW5uCLi/DljuHnH0D7/j9+6eQxaUa/FFuBj3YLj2zx2/tHr5y8jMgVfHZgeLSJ141WuyBvBb7mfEkPL5mKrz0h3GGNf+zm9WMbhk8cwYtuA9AAj5/E6Vr1Lu6rF8JX5uCnJfPhM6vwqSV44qytFCIeu4cn7sTYBzx5mUYKEQ898IkQHtvN6oUfi1cAn+4PnrouK4WIhx54RqdjCHzu4bXCR1RIIeJhAb50Cx/sD56o8O7gC2fwKausHMJPjQ6L8NF5Pfz7J+zzfmTuKHi676mtwFdu4FvRwYRWePBJR42/Z17lIXNHwOeMvqcw+BNzvIeXTcXXHhHuWuBBfPyWetsBmTs1+EIbPLFzOzfhMMDvMbAKBX0NijoabMl+BfHy4MBPjQ5L8N2wDvh3X8IaT3Z6LxCzCk9OP50YFdT40GqNtwzfD+rYx3/+E6/ABfCZM/iYVVY4fGwVPhrntgI/DAH41+t6r+5rOv2SCzJ3Hn4T8ONABN9J075cfJHm/ZObPqhqT+aOgqdzbAeeWVZ4Oe4YfvoBtK//TEeNZxf4cnjsZP3O4fNxbgvwc81vX37h5LLspuGjvcJHaI3/es2NGO9//g/9xv6R8j6ezvFB4YtxbuPwaNu+28f7Gq8V/u72Fz90635ze/sUyYdreOxgvmvVO7gR4xI8es5WJ3xhHv7hl28fuv7+sP7fqFmtw+Nn75TImfCvP//pNeMtpWTu1OBLp/DJKvg3z9sPv/4RDvxmqPHC7t+aahpSlZCPiHDXcQLnq2fgv3c/U9zHJ47g512IAD7DbsFRhn/RfvothIedgL25XOOrcW6jNZ68Prce/uevQJ1Xhmd1QYROXpiCn84PCOCLdfBTjQfoD8/nfHDgp7lNwlMX5FfDgzbCZ8/ulTf1l+FPzPF24NM18Ng+XqLGT3MbhI+pWA8vKHA+fLFj+L5V/+G7t7BVj3b/5hKeqPDO4PPhPgz78Ok0B78cq3XwvHxsBz4+a4C/X3ICJ2d1SLId+GDf8ODTevj3T9hnf8jc4fDZJfjKw+NTa4SHHzTAL7pI4w5+ekDtsPDdsIZN/Uv2eT8yd8rwNXO8Hfhwx/D9YLy6v/r3iy7SuIOPpzn45bhn+GGoq/Ef/yvz5ik5eFGBi+AZOd4MfBvvFn4c6OD/Tq0zFCvwaNkfBr5iJLPXuxR+/gGAkfdqN+CQ8B+/vfn8/35F/XbI3KnCF4bg2WW1DfiCkcxe70J4ZIvfKld4Av7jt4/f/clP94r33Hl4F/BoEw+0zv6T0h6ecTgH4FXvst04PPcp7auGx47p2vbdv1NzZ9b41/uq8Y7gQ0Yye71L4PGTOIroMOh9POPuag9P58MtPHHWVs28Cx2t+kQC/sQcz5telI95euQg8WDw5GUaKUQ8dMAze6LBJq9cwifonRi7gKeuy0oh4sF8kkbxzJ0z+PkKwKHgQyrU3Znn6l9T5wLI3GHw+cbhi9Pe4IkKrwGe99AksSb8ufL84lPqEJ45nje9oMCR4pCEx+7E2CF8eF4PDw7n2u4ea0aBc2t8xnxKnajxNXM8b3pBgSPTz5fjtwh/YiSz17sOHnzSsKnvDufos75k7jz8ZuDhBw3wggJfA1/ON0M4gA92DN8Nbxi+MAI/70aPCt8POoNn5Xg78OV+4YehEPZerfZKmuuGj+c5+OXYlqET+JqRzF7vYvhxIGzvP2dcUxWGhxekifKxAfj5B9DCi+nW30kjA1+5hI9dwOOvHDQBj2zx4QMRahXeHvyJOZ4zvSgf8/THhkebePBkK/2oqzCuGp5TVoeAx47p2tePuc9EcOII8NEO4fGTOKxuaC+EBvjEw1uHJ87aSiHioQGe3S8FCV8zx3OmF+WDsd7DwZOXaaQQ8bAFP51EcQGPXJA3C5/agaeuy0oh4rEePpeBL03AI+fGhPDJzuADKqQQ8VgPn3n40jI8UeGdwTOfWSUmjw3Ap8gc/HJsy+y0a/jgvGX4wiF8ZQ0e3fjZggeftgxfuYRPrcEjvTFhT02ag4cfPDyrHJ3BF1QyZ71r4LthV/DMHFPwJ+Z49vSifEzTo7czCuFLe/D5PLcV+H7Qw7PKET2k2Bv8MBR0p2yVekK5avgYmYNfjlbhi3nu+UdALVoX/DgQdI9CLH8nDT/I3C2Br5nj2dOL8jFNLw8f7hT+PMM/5nZcxQlr8ON+1gU8pycWA/DVPLd5+Lnmd5v6P9sk/LS59fC8mQWp+NoDwn1o3L0+DHyEzMEvR6vwyNym4dG2Pez66D3ddZEo1sMnzuB5ZUUBRk7gM+6idcBjB/Pw9mrrN2JIwse64bHbWC3DnzkPfM7vL27PDfkUOxKilxmzUvG1B4S7o+N4TvcE5OSVS/j58pzFGh9TyZz1LqjxxOl6KUQ8VsNnzuDRR1W2CB9SyZz1qsOT1+ekEPGwCH9ijmdOL8rHOL0CfLIzeOqCvBQiHhrg2U+wmYdP0Tn45bg/+JQKKUQ8DgGPXJC3CH+ikjnrVYYnKvzG4YdTdx6eN7MgFV87AZ+eHcGzc2weHt2UiuGR67L7gwefNg0/nsHx8LyZBan42lPCfV/w01uc727HoSuDr6lkznrXwHfDe4Kf3vD46R9/wPMxTo+dILkAz+6CZwfw/SCE756ZVOgXwx58qAQ/vdP1w9/+TfcW51vyLc6NQkeegeZ3O/PssLPX6N2WhuCHoRQ+H//olVK/GPbgKzX48S3OD9/8iL3TdZpepcbHDmo8du+VGfhxIG0//tXHv3yl9LC0TfiTYDHcGg8DfYvzND16VfaY8PMPAIzs4L/u/lw1/PwW5+ctp8YrwEdO4HMymbPehfDIFn+Et1njE2n4vmmt1KqHb3G+w9/iPAbeudAB4dEm3gBvdR/Pe1h5LTw3H4z1XoafTtbvBh47pmt7eJut+soZPNaB4OHg8ZM4Uoh4rIXPpOGHg2kn8Mne4ImztlKIeKyH5zzPYhwevUZzNHjyMo0UIh4W4UN38Nm+4KnrslKIeBwDvjy5gM/IZM56VeFPVEgh4rEenpNjevK42y1rg8de/XEJPt0VPFHhtw7fN+s9PG9mQSq+dgL+dD4WPHqqfpvwcUUkc9a7Dh588vD0ooYkZqdbu4CHHzYO35f+keALIpmz3jXw3bCHpxc1JDF7W9sBfD8I4XmvDOSFTfhQKzx6ce4ifOQEPieSOetdDj8MnYYbMYZ/pcIu/EkbPH6NZpvwJ9Pw48BpuBGj/1cu+PDzfRDa4GHrzhH8eOpuT/DzD6Adrs7J34fBh3+4/UYGnvvMKmPyWCc8do3mkPDIFl8j/Kff9be80Tc5YlE1teSK4MTp2nse59JQhE8cwKeNUXi0iddqrPHDvY5zgTOraqZS47tO63XVeOxU/UX4bHfw2DGdC3jeYw2syd3Blw7gS5Pw+EkcSWw0rMKHGuGxU/WX4U824Il+oJqswpJ5610AT5y1lfeewi48aN05gmd1s6cdPiDhCyyZt151ePIyjbz3FCuP47NGCnL4u3f4lITPsWTeepXhqeuyUoh4WIWPNcJjZ2yPBV9TIYWIh1V42Kx3BM/qZk87fE3AR4bgiQq/ffjSHTyrmz3t8Mhjkh18bAW+Pm8fHuzkdcFj12guw0e7hQefDgTf1OhrAGTga/phXf3w+JKtwMMPh4IXCB4JvhvePnwc6II/KcIn+4TvBx3AJ9cCnzmBn07dGYIfhiA8vPcGvq7A0tOy+Cb3Inx/Sf7y9KJ89OtNFeFLF/Cn6UDeDPw4UI9doSi8mWYdfHU98Cf78HVjFn7+ASD33ry2Ap81gSJ8oAk+VIVn9K9oGj41C49s8dvpgiys9FKxFj5Ug4+vDh7tb+8Fkg/n8GgTb4J/KetuHT5sZLpOMQDP6GZPBn7ui+cpchciNSsTHjlnqx8eO6Yb4D9+K/96krXwcqdgp6EM28mvgI9V4aNl8GjvW/2A4FY08s4yAC9VvIpRE+4T/MubG+kXTlqGx3fyVuFr6iltKfgX040Jd1gnTFI1PjZV44mztnLWWNiGjzXBR6rw2UJ4tL+9N0h/e3LwGZrMW686PHmZRpndAXyoB76wBI/3t7cReOq67BXAJ1rgm1oZvlwGj/W39xTJh0P4hoorgMdad1bhT8vgefmQhM9Zi14LT1T464CPAx3wJ5EgO4nuZm8n8M35GuDLRAt86uFndwfwTa0OHzqCp7vZMw8fRMbh4YdrgW9Y443DZ/bh68Y4fDdsHb4iAGTg0Z38cvhwAXxN9stgAX5s1puC7wcdwAfXA1/ah09Nww9DEH54J430y8RXwWcEgAz8GdnJL4ePrwK+NAw/DjTzjRh2XlSQyT4EiY53Bk/1tnb18NMPYL4RY8vwsQb4yMPPFb7b1A/X42UvzrmAj6ad/FJ4eFe9OjzV25oV+JyxaD3wyK6+nbtEeG3jsuwi+CxxBJ+5gI+MwaNt+3Z4J83jbcOHjuDrZkfw2MF8O72T5sbKPXeL4Mt5J78Y/rQEvnQAH0QZY9Ea4PGzd1KIeFwnfCoU5CWRva3ZgI/NwBOn66UQ8XAAn02dznl41ool4Mnrc1KIeKyCh32dLYCfWneL4cNF8EEj3ENcDzx1QV4KEY918LJ90+Ljp9adZfisyY3C029bNQXv+g4ccpNrDT5eBA9bd3bh0yZOGIteCa8l1sBXS+FjZ/CVSfiIBR8xFn398OEi+CxaC18sg0+FN+cagJ8O5PcFT50Kk4YfmvW24YMmNwnPeGRgPJD38N345LQKvusAZwm8+DkMM/Cxh5/Hj6076/B1I+gzycMzv+iW4E9L4VOj8DUTPqEXfVz4eB18uhQ+axL+bB6e+UV1wmdL4YcTVeTblM/nlhrDTmqiQnI2mCYqD4Ydo88HD4+Pj9bV+JAqLMkaXzb4tl5vjWfBh0FEL/ra4bvXkiyD77eK9uEDwevqPDzzi7LgpV8LTo4fLtMshY+pwpKFF72n0Ah83TfrdwafMkfTX4aGD1fB51RhycOfCm6aAfh02MnvCr5yBl9QhSUPj1V54/DlPuHJfa00/NCsXwbf91y9EP6MdXRvAT4MPDwyPnIHf+KnkfOJ8iELX+4Pnn789Crg64ibRs4nyoeH5+T4Anx3mWYh/GkNPPZSEwvw9VXDM8+GZdQzXLwTYfR4cDwnmp4XfVmmTCUBIJaGbuutwEfUoq8Hnszd6hrfN+sX1viV8DU/jZhPlA9JeNispxZ9YPhsDXxIF5YCPLqttwFfB9nO4Ptt5jL4/nVgC+FjurCU4Gt+Gj6fKB8K8ImHL7XAF3RhKcGze1/y8OwvyoCn9rUK8N1lGjfwyLbeBvyp9vDI+O54zhV8zU/D5hPlQxYerG138FQjSwE+Sd3Bzw8+ePgLQeZuPXzXrHcGX3PTsPlE+VCAD/YFXzVUphXgS4fwc/POw18IMnca4OPl8IzCUoNPxiq/FJ551hE7k4kkN2T38uJ7/VipyqyX45Dw2Vjltdb4jF3jqYfJmTOLU5VZL8dy+GwdPDyecwVfpSbgIw8vMx4ezzmDH7f1Hv5CkLmDIxgva1WBh816V/DMh/dWw/Pepbg3+OHy5lL40iV8xniGyyB84uGR8bFL+KihbgFaDV8fBT6lMn018Hl/B5CHvxRk7nTAg2a9M/gqMQDfEHNPQbzHgzmzOFWZ9XI4hE9dwvcvSPHwF4LMXTveXL0GPnQHX2Yxdbenh2d/UVKyGK5qL4YvXcLnHl5qKjJ3YETe0JlWgynQVEEAAAiKSURBVI/RV8nbho+CpvHwF4PMXTu3YVfA1+7giygk7wTx8OwvSkqOt6cvh49Sd/CgdefhJYLMnR740CV87OElgsxdOx3NrYAvQ3Qnbxce7uSJq0QG4dPaw6PjsZ28dfjQHny4K/iQzrQqfHoMeLCt3w98pQE+cghfwJ184+EvBJm7Fr4vl860Kjy6rbcPD3byOuGzY8BPDxuvgMe29Zbhq25brxM+koYndzHHg4/SucofCb45PDzcz7KmF+VDD3zXusNOHa6FrwXwaY1+Kq8aPmVkWhW+jUGVZ536FeVDE3y/k2enjfOJ8qEEH2LwtYePZnkH8KFW+IacG4kGgyd3MdcEX49Hc+vgy1neNny/k2enjfOJ8qEIj3S806TELua64OM5W8wcS8JHcXzq6F3AEwIG4dGdfFNeMfzcddQ6eCAfRV2ltw1f5tRO3iB8OFd5sNk/eXgQRQ7fStVYh6d38kmCvr9CL3w6Hb7A1tEVw6dItpg5VhhfZGGN3Y0jzIdeeGS1SZKh8jrhS/ge0KjvUrNJg+Bq4Wut8PDJlto6PLmTT5I8zxF5RfjsAnw49pvdBHF8tfDN1KjXA19mAfYmH1E+NMJjO/mkKMo8WwwfCeGT7l61Tr4JyiuGP8VItpg5VhyfoZVPmA9d8MS2PsmKc1UhVV4Rvr4EHzRFBF87CY+HhKcMtw3PzPQK+DKcT+LZhB8J8qSoqu4vMp8oH4rwUDxJgPwJ7uuFJxA2DI/s4rXBF2EwyQvzoQ0e7uSnbT3Y0Hdvmp6rvCI8sfVmwoO/UZNGwP9K4ZtTiGaLmWP18XPbXpgPjfDzth5WeJjWdDHOJ8qHGvw5KfN+m9DEWTVfyQsZ/fJuF742Az/LC/OhDb7b1g9NiwTCQ/MaRG+vGT4fXq/ZFFlWDf0HlWEQ0K9S2y5806Qxmi1mjpeMz8fXkonyoRG+39Y3fYUH2kE4BHzMRjM8OF5ohtznWQaa9jADATiwoDK8Qfi+PoIKH7BLci382LGOMB/64OEBXdhdKUgS4A6Or2Hk3b8y8OjZH/IsLIWXzPDgF9ekWVkUYAF5EFAn8tB5mw3Ag+1gvws8pfOWXjN8aRO+39ZD+QRW9y4tAuhRNdweJcoHAU9ed6FrbZ/x4RWboImXgXoPGslRemqahjdvugl4cDhyOp2a0wnZ0l83fFfloTza/WTX0JOAb9DzzIQ7Ex5uFcZ3qzZRksOaVBaglcE9FAybTcDDJlCYgghb4isxvu01wFewygcnGOiuVhYe/GKmfZ4MPJxoPGJogu6YrklT0JisObdmR+lG4GHrNwZtn3In8H2VD8BPGXvzb9fUk4APMmX4YIbvmvZNDU8hnVi3bVVFEZ02Aw8vXYJmyl7gYZWHv+QIT5OFL6ZtPdm248DX9QSfdt0DNN2olAUP3MMm2ww89bWuGr4tCticq4g0UOVl4LOiHKs82bbjwDczfN1XfriZD87EVWn4T1V0Txp5+CkfWuHB9rQoKiotSWTg4QGZEvx0HNB299r2XwZs/8/4tr6bF1R4sKUvPPyUD63woGZVrDQ5+LJoTvDt8GXW4MuVgR+GwZ8gSCl4WOGDxsMj+dAMz07L5eArUOXhy+xrSXgkFdm4h0GJbevbvmUHO2F0AH93+4sf0C9qG35aP5qReRLD8PPhHC8fbX8OrjuLeWrU4dEgqnwLN/Rdhe9eCmAX/uGXb8F/aIHbhZ/Wj2VknsQWPDcfPTyQr7vT/avgwyBAq3zb1feuWy77jbs3z9sPv/4RDNzC6EY1VoJc/ziwlXy0bvKhPbjwL9pPv/1x/ET+aM3V+H48sn4sI9w6pL3Gl0ON5+ZDXKXVavzFVJvw4w/cFTxV0xzB8/KxV3jGPp6dNUPwgn08q7CMwQv28YJ5rxie0apnZ80QfL/+D9+9pVv1rMIyBs/Nx27hsSBzZwGemw9mYZmD5+XDw3Ny7OEFyR6eM16UD2ZheXjV8PCCNFE+PDwnxx5ekOzhOeNF+WAWlodXDQ8vSBPlw8NzcuzhBckenjNelA9mYXl41fDwgjRRPjw8J8ceXpDs4TnjRflgFpaHVw0PL0gT5cPDc3Ls4QXJHp4zXpQPZmF5eNWQgyfjVmm0tvH8EMwhWtjStLXJa1I1hYdfkrY22cOrjeeHh1cND78kbW3y1cL7uPrw8AcND3/Q8PAHDQ9/0FCGH58r+PT97e30ZAnzWWLexPhkb54zpm/f3N4+VcoOuWY8iUqbHoeiZ0PTGIl9kF+Il6sF8xJFYipU4edHigDM3QtyJPbgFXtifLKH2+cXFi6ZHXzN6JhP/0gjPNx+82PLnG1OY803TSPMIGupsvMSRWIsVOGxZwffvCBG4o9asifGxv/zf/9/yLecl/MbyRrPWzM65sPf/g25sE+/G558pWeb0xjz4evm4jGWKj0vUSTGQhkeeVr44Sk5En+4mj0xOh4Uz8Nzxvi7p8KyYcxBrBkd8wAqMLWwEZ6abU5jzjfHA/9HwVyq5LxEkRgLJfi726fIj/luyr1Ejb9Dv+o8Pexl4DljPChvqa8vU+NhUAvj1/gWRWNm4g5uCO4EG4NLNV44L14kxmLxPv7T94x9Nm8fj05MTPbA28dL1XiZfTxcA6/GM/fGYxprvnGS70W5E+/jxfO2kj/5tbGsVf/hu7d36C+T+Swxb2J0euJbTuPfyP7qeWvGk+iFQVz2bGgaNxPkF2Llip94oU5vE97HPsLDHzQ8/EHDwx80PPxBw8MfNPYO/+7f/odHr94/uXn0ynVONha7h//y67Z9+bh9/YXrnGwsdg//s1ft+6+ete9/7qs8FoeAf3Jzc/PZM9dZ2VYcAt7XdjqOAA/38fef/+Q6K9uKQ8CDbb3f0hOxd3gfnPDwBw0Pf9Dw8AcND3/Q8PAHDQ9/0PDwBw0Pf9Dw8AeN/w9G1t6/DlKknAAAAABJRU5ErkJggg==" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">ggplot(data = rr, aes(y = rae, x = factor(lvl), fill = factor(lvl))) + geom_boxplot() + 
    coord_flip()
</code></pre>

<pre><code>## Warning: Removed 81 rows containing non-finite values (stat_boxplot).
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">

# pacf(mm$residuals)
# 
# boxplot(results$re~results$k)
# 
# summary(mm) plot(mm)


# test.reg.roll = function(mod.reg, xreg, h) {
# 
# # takes the model and the xreg args and does an h-step ahead forecast
# 
# foreach (o = 300:(end.week-1), .combine=&#39;dtcomb&#39;, .multicombine=TRUE)
# %do% #(fit.week.end) #(end.week-1) { print(o)
# 
# # build the xreg variables, based on the variables in formula!!  xregnew
# = ssw[WEEK %in% (o+1):(o+h), eval(model.vars), with = F]
# 
# #fit.model = f_ts.regression.auto.stepAIC(ssw[1:o]) # window.t = 1:198
# revised.model = lm(formula = frm.text, data=ssw[1:o])
# 
# fc = predict.lm(object=revised.model,newdata=xregnew) # fc =
# forecast(revised.model, # h=min(h, end.week-o), # newdata =
# data.frame(xregnew))
# 
# act = ssw[WEEK %in% c(o+1:(o+min(h, end.week-o))),UNITS]
# 
# fc.comparison = data.table(t = o, k = 1:min(h, end.week-o), fc = fc,
# act) fc.comparison[,`:=`(e=fc-act, re = (fc-act)/act)]
# print(fc.comparison) fc.comparison }
# 
# }
</code></pre>

<!-- Automatically generated by RStudio [12861c30b10411e1afa60800200c9a66] -->

</body>

</html>

